問題文
-
Description
RED, RED, RED, RED
Download the image: red.png
-

fileコマンドでファイル形式を調べる

$ file red.png
red.png: PNG image data, 128 x 128, 8-bit/color RGBA, non-interlaced

pngコマンドでもPNGと認識している

ファイルのメタデータを確認するためにexiftoolを使用する

$ exiftool red.png
ExifTool Version Number         : 13.25
File Name                       : red.png
Directory                       : .
File Size                       : 796 bytes
File Modification Date/Time     : 2025:10:21 10:23:49+09:00
File Access Date/Time           : 2025:10:21 10:23:58+09:00
File Inode Change Date/Time     : 2025:10:21 10:23:58+09:00
File Permissions                : -rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 128
Image Height                    : 128
Bit Depth                       : 8
Color Type                      : RGB with Alpha
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Poem                            : Crimson heart, vibrant and bold,.Hearts flutter at your sight..Evenings glow softly red,.Cherries burst with sweet life..Kisses linger with your warmth..Love deep as merlot..Scarlet leaves falling softly,.Bold in every stroke.
Image Size                      : 128x128
Megapixels                      : 0.016

ここでPoem欄に文章が書かれていることが分かる

-
Poem                            : Crimson heart, vibrant and bold,.Hearts flutter at your sight..Evenings glow softly red,.Cherries burst with sweet life..Kisses linger with your warmth..Love deep as merlot..Scarlet leaves falling softly,.Bold in every stroke.
-

この文章から各文の一文字目を取ると、CHECKLSBという文字が浮かび上がる

LSBを解析するのにzsetgというツールを使用する

zsteg は 公式APTリポジトリに含まれていない ため、手動インストール（RubyGem経由）する必要があります

$ sudo apt update
$ sudo apt install ruby ruby-dev imagemagick libmagickwand-dev

imagemagick は PNG解析の内部で利用されます。

RubyGems から zsteg をインストール
$ sudo gem install zsteg

$ zsteg red.png
meta Poem           .. text: "Crimson heart, vibrant and bold,\nHearts flutter at your sight.\nEvenings glow softly red,\nCherries burst with sweet life.\nKisses linger with your warmth.\nLove deep as merlot.\nScarlet leaves falling softly,\nBold in every stroke."
b1,rgba,lsb,xy      .. text: "cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ==cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ==cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ==cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ=="
b1,rgba,msb,xy      .. file: OpenPGP Public Key
b2,g,lsb,xy         .. text: "ET@UETPETUUT@TUUTD@PDUDDDPE"
b2,rgb,lsb,xy       .. file: OpenPGP Secret Key
b2,bgr,msb,xy       .. file: OpenPGP Public Key
b2,rgba,lsb,xy      .. file: OpenPGP Secret Key
b2,rgba,msb,xy      .. text: "CIkiiiII"
b2,abgr,lsb,xy      .. file: OpenPGP Secret Key
b2,abgr,msb,xy      .. text: "iiiaakikk"
b3,rgba,msb,xy      .. text: "#wb#wp#7p"
b3,abgr,msb,xy      .. text: "7r'wb#7p"
b4,b,lsb,xy         .. file: 0421 Alliant compact executable not stripped

この情報から"cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ=="という文字列が分かります

ここでのBase64の末尾に現れる「=」や「==」は、パディング（padding） と呼ばれるものです。Base64の末尾に現れます。

pythonでBase64をデコードするスクリプトを記述します。

import base64
cipher = "cGljb0NURntyM2RfMXNfdGgzX3VsdDFtNHQzX2N1cjNfZjByXzU0ZG4zNTVffQ=="
plain = base64.b64decode(cipher).decode()
print(plain)

実行すると

$ python3 a.py 
picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}

フラグ
picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}